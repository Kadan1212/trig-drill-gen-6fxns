<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Trig Drill Generator</title>
<link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
<style>
/* FRACTIONS & SQUARE ROOTS */
.frac { display:inline-block; vertical-align:middle; text-align:center; font-size:0.5em; margin:0 0.1em; }
.numer { display:table; border-bottom:0.03em solid currentColor; vertical-align:middle; }
.sqrt { margin:0 0.1em; position:relative; }
.sqrt::before { content:'√'; }
.sqrt::after { content:''; display:block; position:absolute; top:0.25em; left:0.9ch; right:0; border-top:0.03em solid currentColor; height:1px; }

/* BASE STYLES */
html,body {
  height:100%;
  width:100%;
  margin:0;
  font-family:"Open Sans",sans-serif;
  color:#333;
  background:#fbfbfb;
  --problem-n:0;
  font-size:0;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
}

/* CONTAINER STATES */
body.show-intro-modal .intro-modal.not-score { display:flex; }
body.show-intro-modal .solutions { display:none; }
body.show-solutions .solutions { display:grid; }
body.show-intro-modal .problems { display:none; }
body.show-score .intro-modal.not-score { display:none; }

/* MODALS */
.intro-modal {
  position: relative;
  z-index: 10;
  box-shadow:0 3px 20px rgba(0,0,0,0.45);
  border-radius:20px;
  padding:28px;
  display:none;
  flex-direction:column;
  width:380px;
  box-sizing:border-box;
  background:white;
}
h1 { margin:0 0 12px 0; font-weight:normal; font-size:28px; }
h2 { margin:0 0 12px 0; font-weight:normal; color:#666; font-size:14px; }
#start,#menu {
  background:#2092e3;
  color:white;
  border:none;
  padding:10px;
  border-radius:10px;
  font-size:16px;
  cursor:pointer;
  width:100%;
  margin-top:10px;
}
.options { max-height:40vh; overflow:auto; margin-top:6px; }
.options p { margin:8px 0; font-size:14px; }
.options label, .options input[type=checkbox] { cursor:pointer; }

/* PROBLEMS AREA */
.problems {
  padding-top:40vh;
  margin-top:calc(var(--problem-n) * -20vh);
  transition:margin-top .2s;
  width:50vw;
  box-sizing:border-box;
}
.problem {
  font-size:14vh;
  font-family:serif;
  padding:3vh 3vw;
  width:50vw;
  min-width:50vh;
  height:20vh;
  border-right:3px solid rgba(0,0,0,0.08);
  box-sizing:border-box;
  text-align:right;
  opacity:0.5;
  position:relative;
  transition:opacity .15s, color .15s, background .15s;
}
.problem.current { opacity:1; color:#000; background:transparent; }
.answer {
  position:absolute;
  left:10px;
  top:0;
  bottom:0;
  display:flex;
  align-items:center;
  opacity:0;
  font-size:0.5em;
  transition:opacity .15s;
}
.problem.correct { color:#0a530a; }
.problem.wrong { color:#d12525; }
.problem.correct .answer, .problem.wrong .answer { opacity:1; }

/* SOLUTIONS GRID */
.solutions {
  z-index:20;
  pointer-events:auto;
  width:36vw;
  position:fixed;
  right:0;
  top:0;
  height:100%;
  display:grid;
  grid-template-columns:repeat(3,1fr);
  grid-auto-rows:1fr;
  gap:16px;
  padding:24px;
  box-sizing:border-box;
  align-content:center;
  justify-items:stretch;
}

/* SCORE MODAL */
.intro-modal.score { display:none; width:500px; }
body.show-score .intro-modal.score { display:flex; }

/* RESPONSIVE */
@media (max-width: 900px) {
  .intro-modal { width:320px; }
  .solutions {
    position:fixed;
    bottom:0;
    top:auto;
    width:100%;
    height:50vh;
    grid-template-columns: repeat(3,1fr);
    padding:14px;
    gap:10px;
  }
  .problems, .problem { width:100vw; min-width:0; }
}
</style>
</head>
<body class="show-intro-modal">

<div class="intro-modal not-score">
  <h1>Trig Drill Generator</h1>
  <h2>Options</h2>
  <div class="options">
    <p><input type="checkbox" id="degrees" checked> <label for="degrees">Degrees?</label></p>
    <p><input type="checkbox" id="radian" checked> <label for="radian">Radians?</label></p>
    <p><input type="checkbox" id="tan" checked> <label for="tan">Include tan problems?</label></p>
    <p><input type="checkbox" id="cot" checked> <label for="cot">Include cot problems?</label></p>
    <p><input type="checkbox" id="sec" checked> <label for="sec">Include sec problems?</label></p>
    <p><input type="checkbox" id="csc" checked> <label for="csc">Include csc problems?</label></p>
    <p><input type="checkbox" id="deg90s" checked> <label for="deg90s">Include 90°-type angles?</label></p>
    <p><input type="checkbox" id="deg30s" checked> <label for="deg30s">Include 30° & 60° angles?</label></p>
    <p><input type="checkbox" id="deg45s" checked> <label for="deg45s">Include 45° angles?</label></p>
    <p><input type="checkbox" id="include360" checked> <label for="include360">Include 360°?</label></p>
    <p><input type="checkbox" id="coterminal" checked> <label for="coterminal">Include coterminal angles?</label></p>
    <p><input type="checkbox" id="quadionly"> <label for="quadionly">Limit to quadrant I angles?</label></p>
    <p><input type="checkbox" id="showcorrectness" checked> <label for="showcorrectness">Show wrong answers?</label></p>
    <p><input type="checkbox" id="showcorrect" checked> <label for="showcorrect">Show correct answers?</label></p>
    <p><input type="checkbox" id="showtime" checked> <label for="showtime">Show time?</label></p>
    <p><input type="checkbox" id="limit20"> <label for="limit20">Limit to twenty problems?</label></p>
  </div>
  <button id="start">Start</button>
</div>

<div class="intro-modal score">
  <div id="score"></div>
  <button id="menu">Menu</button>
</div>

<div class="problems" id="problems"></div>

<div class="solutions" id="solutions">
  <div class="solution" data-answer="1/2">1/2</div>
  <div class="solution" data-answer="rt2/2">√2/2</div>
  <div class="solution" data-answer="rt3/2">√3/2</div>
  <div class="solution" data-answer="1">1</div>
  <div class="solution" data-answer="0">0</div>
  <div class="solution" data-answer="null">undefined</div>
</div>

<div class="clock" id="clock">0:00.000</div>

<script>
document.addEventListener('DOMContentLoaded',()=>{

const checkboxes = {
  useDegrees: document.getElementById('degrees'),
  radians: document.getElementById('radian'),
  tan: document.getElementById('tan'),
  cot: document.getElementById('cot'),
  sec: document.getElementById('sec'),
  csc: document.getElementById('csc'),
  deg90s: document.getElementById('deg90s'),
  deg30s: document.getElementById('deg30s'),
  deg45s: document.getElementById('deg45s'),
  include360: document.getElementById('include360'),
  coterminal: document.getElementById('coterminal'),
  quadIOnly: document.getElementById('quadionly'),
  showCorrectness: document.getElementById('showcorrectness'),
  showCorrect: document.getElementById('showcorrect'),
  showTime: document.getElementById('showtime'),
  limit20: document.getElementById('limit20')
};

const problemsWrapper=document.getElementById('problems');
const solutions=document.getElementById('solutions');
const scoreEl=document.getElementById('score');
const clock=document.getElementById('clock');

let problems=[],current=0,rights=0,wrongs=0,playing=false,startTime=0,clockRAF=null;

function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}
function formatTime(ms){const m=Math.floor(ms/60000).toString().padStart(2,'0');const s=Math.floor(ms/1000)%60;const sec=s.toString().padStart(2,'0');const ms3=Math.floor(ms%1000).toString().padStart(3,'0');return `${m}:${sec}.${ms3}`;}
function startClock(){clock.textContent=formatTime(Date.now()-startTime);clockRAF=requestAnimationFrame(startClock);}
function stopClock(){if(clockRAF) cancelAnimationFrame(clockRAF); clockRAF=null;}

/* --- full angle table --- */
const answers = {
  0:[0,1,0],
  30:['1/2','rt3/2','rt3/3'],
  45:['rt2/2','rt2/2',1],
  60:['rt3/2','1/2','rt3'],
  90:[1,0,null],
  120:['rt3/2','-1/2','-rt3'],
  135:['rt2/2','-rt2/2',-1],
  150:['1/2','-rt3/2','-rt3/3'],
  180:[0,-1,0],
  210:['-1/2','-rt3/2','rt3/3'],
  225:['-rt2/2','-rt2/2',1],
  240:['-rt3/2','-1/2','rt3'],
  270:[-1,0,null],
  300:['-rt3/2','1/2','-rt3'],
  315:['-rt2/2','rt2/2',-1],
  330:['-1/2','rt3/2','-rt3/3'],
  360:[0,1,0]
};

function getAnswers(deg){
  deg=((deg%360)+360)%360;
  if(answers[deg]!==undefined) return answers[deg].slice();
  throw new Error('angle not supported: '+deg);
}

function invert(val){
  if(val===0||val===null) return null;
  if(typeof val==='number') return 1/val;
  const neg=val.startsWith('-'); const v=neg?val.slice(1):val;
  const map={'1/2':'2','rt2/2':'rt2','rt3/2':'2/rt3','rt3/3':'rt3','rt2':'rt2/2','rt3':'rt3/3','2':'1/2','1/3':'3','3/2':'2/3','2rt3/3':'(2√3)/3'};
  const res=map[v]||(''+(1/parseFloat(v)));
  return neg?'-'+res:res;
}

/* Build problems */
function generateDrill(opts={}){
  const {useDegrees=true,radians=false,includeTan=false,includeCot=false,includeSec=false,includeCsc=false,
         deg90s=true,deg30s=true,deg45s=true,include360=true,coterminal=false,quadIOnly=false}=opts;
  const list=[];
  const angles=[];
  if(deg90s){angles.push(0,90); if(!quadIOnly){angles.push(180,270);}}
  if(include360) angles.push(360);
  if(deg30s){angles.push(30,60); if(!quadIOnly){angles.push(120,150,210,240,300,330);}}
  if(deg45s){angles.push(45); if(!quadIOnly){angles.push(135,225,315);}}
  angles.forEach(d=>{
    const [s,c,t]=getAnswers(d);
    if(useDegrees){
      list.push({fn:'sin',arg:d,type:'degrees',answer:s});
      list.push({fn:'cos',arg:d,type:'degrees',answer:c});
      if(includeTan) list.push({fn:'tan',arg:d,type:'degrees',answer:t});
      if(includeCot) list.push({fn:'cot',arg:d,type:'degrees',answer:invert(t)});
      if(includeSec) list.push({fn:'sec',arg:d,type:'degrees',answer:invert(c)});
      if(includeCsc) list.push({fn:'csc',arg:d,type:'degrees',answer:invert(s)});
    }
    if(radians){
      const radMap={0:"0",30:"π/6",45:"π/4",60:"π/3",90:"π/2",120:"2π/3",135:"3π/4",150:"5π/6",180:"π",
                    210:"7π/6",225:"5π/4",240:"4π/3",270:"3π/2",300:"5π/3",315:"7π/4",330:"11π/6",360:"2π"};
      const rad=radMap[d]||d+"π/180";
      list.push({fn:'sin',arg:rad,type:'radians',answer:s});
      list.push({fn:'cos',arg:rad,type:'radians',answer:c});
      if(includeTan) list.push({fn:'tan',arg:rad,type:'radians',answer:t});
      if(includeCot) list.push({fn:'cot',arg:rad,type:'radians',answer:invert(t)});
      if(includeSec) list.push({fn:'sec',arg:rad,type:'radians',answer:invert(c)});
      if(includeCsc) list.push({fn:'csc',arg:rad,type:'radians',answer:invert(s)});
    }
  });
  return list;
}

/* render problems */
function solutionFor(answer){if(answer===null) return 'undefined'; return answer;}
function renderProblems(){let html='';problems.forEach((p,idx)=>{const probClass=idx===current?'problem current':'problem'; const answerHTML=(idx<current)?`<span class="answer">${solutionFor(p.answer)}</span>`:`<span class="answer"></span>`; html+=`<div class="${probClass}" data-index="${idx}">${answerHTML}<span><span class="fn">${p.fn}</span> ${p.arg}${p.type==='degrees'?'°':''}</span></div>`;});problemsWrapper.innerHTML=html; document.body.style.setProperty('--problem-n',current);}
function submitAnswer(answer){if(!playing) return; const problem=problems[current]; const correct=problem.answer; const problemEl=problemsWrapper.children[current]; const matched=answer==correct; if(matched){problemEl.classList.add('correct'); rights++;}else{problemEl.classList.add('wrong'); wrongs++; problemEl.querySelector('.answer').innerHTML=solutionFor(correct);} current++; problemEl.classList.remove('current'); document.body.style.setProperty('--problem-n',current); if(current>=problems.length){playing=false; stopClock(); scoreEl.innerHTML=`It took <strong>${formatTime(Date.now()-startTime)}</strong> to get <strong>${rights}</strong> out of ${problems.length} correct.`; document.body.classList.add('show-intro-modal','show-score'); return;} const next=problemsWrapper.children[current]; if(next) next.classList.add('current');}

document.getElementById('start').addEventListener('click',()=>{
  if(playing)return;
  const opts={};
  Object.keys(checkboxes).forEach(k=>opts[k]=checkboxes[k].checked);
  problems=shuffle(generateDrill(opts));
  if(opts.limit20) problems=problems.slice(0,20);
  if(!problems.length){alert('No problems with these options.'); return;}
  current=0;rights=0;wrongs=0;
  renderProblems();
  document.body.classList.remove('show-intro-modal','show-score');
  document.body.classList.add('show-solutions');
  startTime=Date.now(); startClock();
  playing=true;
});

document.getElementById('menu').addEventListener('click',()=>{
  document.body.classList.remove('show-score','show-solutions');
  document.body.classList.add('show-intro-modal');
  problemsWrapper.innerHTML='';
});

solutions.addEventListener('click',e=>{
  const el=e.target.closest('.solution');if(!el)return;submitAnswer(el.dataset.answer);
});

solutions.setAttribute('aria-hidden','true');
});
</script>
</body>
</html>
